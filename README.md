# QiangxieSystem-leo
互联网开发作业：抢鞋系统

 
一、	系统功能介绍
这一部分主要对前端页面和后端页面的功能进行介绍。
一、	前端页面功能
前端页面主要使用bootstrap进行编写，主界面如下图所示：
 
1、	登陆功能：用户输入用户名和密码进行登陆
 
2、	界面左侧是标签栏，一共包括三个品牌的鞋子，安踏、李宁和AJ，通过点击可以到达三个品牌的界面：
下面是李宁的界面和aj的界面
 
 
3、	右侧上方商品以轮播图的形式进行展示，可以通过点击图片左侧和右侧进行图片切换，也可以按照时间进行定时切换。

4、	右侧下方是对商品进行购买的表格，每款鞋子包括男款和女款两种，两种价位不同，可以通过下拉框选择尺码，然后点击购买按钮对球鞋进行购买。
 





二、	后端页面功能
1、	登陆功能：和前端界面相同，但是将登陆的管理员分为两个，一个权限为1，一个权限为2，进行不同的管理功能。
2、	首页（欢迎页）：首页界面如下图所示，可以看到，左侧是导航栏，可以通过点击进行不同界面的切换，右上方展示的是你的权限id，首页展示的是公告的内容。首页的界面如下图所示
 
3、	管理员1可以进行人员管理，有以下五个权限：查看管理员列表、查看用户列表，用户删除、管理员管理、人员查询功能。管理员2，只有查看用户列表、用户删除、人员查询功能。
（1）查看管理员列表功能，管理员列表可以展示管理员的姓名和其权限：
 
（2）展示用户列表功能，展示用户名ID和用户姓名以及用户邮箱。
（3）用户删除功能：通过输入用户ID，并对管理员身份进行确认之后即可对用户进行删除。
 
（4）管理员管理功能，通过下拉选框可以选择对管理员进行的操作，可以进行删除、增加、修改权限的功能，并通过Ajax显示所操作管理员的权限。
 
（5）人员查询功能，通过输入用户或者管理员姓名都可从数据库中获得所查人员的具体信息。
 
4、	管理员1和管理员2 都可以对商品进行以下三种操作，商品
列表查询、商品修改、商品查询功能。
（1）商品列表查询功能，可以将数据库中的所有商品数据进行展示，包括商品名称、鞋码和剩余库存信息
 
		（2）商品修改功能，可以通过下拉列表对商品进行删除和修改数量的选择，并且在对用户名和密码的核实之后进行操作
 
		（3）商品查询功能，对商品进行查询，显示球鞋ID，球鞋名称，球鞋大小和球鞋数量的商品信息
 
5、	管理员1和管理员2都可进行修改密码操作：
 
6、	管理员1可以进行日志的查看，管理员2没有此权限，日志记录了所有对数据库进行修改或删除的操作，包括操作人的姓名、权限以及具体的操作内容和操作
 
二、系统功能设计与实现
一、前端界面设计与实现
	前端界面主要包括了三个view层的html文件和一个controller层的php文件，对于上述功能的具体实现如下：
1、	轮播图的实现，调用了bootstrap的css包，实现了轮播图：
 
2、	购买表格的实现，包括图片，下拉框和提交按钮的实现
 
3、	在购买的时候，系统会查询数据库中对应的球鞋数量，如果球鞋数量不够的话，会出现“ 已经被抢空”的提醒，如果足够，那么球鞋对应数量减一
 
 
二、后端界面设计与实现
	后端界面的实现，view层有三个文件夹，其中包括一个登陆的文件夹，还有一个权限为1的user的html文件夹，一共包括12个html文件，另一个为权限为2的user2的html文件夹，一共包括6个html文件。在controller层有三个控制器文件。对上一节中展示的具体功能的实现如下所示：
（1）	登陆界面，html文件较为简单不在赘述，php文件中对不同的用户和管理员进行身份识别，并且会将其用户名和role存放在session中供之后使用。如图（1）所示
（2）	公告的获取，前端遍历查询数据进行展示，如图所示：
 
 
 
图（1）
（3）	删除功能的实现，以用户删除为例，如果用户无法在数据库中查找到，在页面中展示用户不存在，如果找到并且管理员账号密码输入无误之后，则显示删除成功：
 
（4）	查询功能的实现，查询功能包括人员查询和商品查询，主要通过ID或者名字从数据库中进行查找，下图是人员查询的示例。
 
（5）	增加功能的实现，以增加管理员为例，先从数据库中查找这个管理员的姓名是否已经存在，如果存在则在界面中进行提醒，如果不存在的话，增加管理员。
 
（6）	修改功能的实现，以修改管理员权限为例，先从数据库中查找这个管理员的姓名是否存在，如果不存在的话，在界面中进行提醒，否则，对其权限进行修改
 
（7）	上述增删改查的功能的view层实现，以管理员管理中的下拉菜单为例，通过表单中的name名称获取通过post方式提交的信息，比如下拉菜单中“select name=type“，通过type获取提交的信息，然后调用controller层中user.php中的dogly方法。
 
（8）	日志系统的实现，规定每次对数据中的数据有任何修改则会将操作内容加入到日志系统，其中日志的内容包括操作人员，操作人权限、操作的具体内容和操作的时间戳，并且权限为1的管理员可以进行日志的查看。
 
三、	数据库设计与实现
数据库的实现使用了较为简单的方式，需要后期再进行调整，
主要包括6个表，分别如下：
Users：保存的是管理员的信息，包括管理员的姓名和管理员的密码。
 
user-role：保存的是管理员的id和权限的对应关系：
 
Shoes：保存的是球鞋信息，包括球鞋的id，名称，大小，库存数量和介绍。
 
Log：保存的是日志信息，包括修改人的姓名，权限，操作的内容和时间戳信息
 
Gonggao：保存的是公告信息，包括公告id和公告内容：
 
三、	性能优化策略设计与实现
性能优化主要体现在了下面两个方面
1.	使用ajax进行异步传输，这样在前端就可以对数据进行初步筛选，减小后端压力

2.	使用rabbitMq消息队列，解决高并发问题
首先tp5对于rabbitMq要进行一系列的配置

在配置完成之后，创建通道建立连接，初始化rabbitmq并创建交换区与队列：
 

构建生产者和消费者模式，生产者：

消费者：


 
四、	安全功能设计与实现
安全功能主要在以下几个方面进行实现：
1、	密码存储使用了加密存储的方式，主要实现方式如下图所示，使用此方法对明文密码进行修改并存储
 
2、	在完成项目的过程中，发现不需要登陆也可以访问到系统的某些界面，因此在所有方法调用之前都需要判断是否已经登陆，如果已经登陆，那么之前就已经将user和role 的信息保存到session中，因此，首先检查session，如果这两项内容都存在，才可以进行访问，如果不存在，进入系统的404界面，实现如下：
 
3、	日志系统，通过日志系统，对管理员的所有操作进行管理，如果有不法分子危及到了数据库系统，则可以实时看到操作的状态。
4、	权限分离，分为权限为1的管理员和权限为2的管理员，这样保证了数据的操作不会混乱，并且将重要的操作掌握在自己手中，保证了系统的安全
5、	使用ajax对密码等进行一定的要求，在前端判断输入是否有效，防止sql注入等问题的发生。
6、	使用tp5中封装好的数据库操作指令，有效的防止了数据库sql注入等危险的发生
7、	数据库数据进行删除的时候，需要再次验证管理员的账号密码，进一步保证了数据的安全。



 
五、	总结与展望
在这一个学期的学习中，我学到了很多东西，不仅仅是编程的语言，学到的是一种学习的方法。这是一段难忘的经历，因为我从什么也不会，到现在终于能搭建出自己的服务器和看起来还十分简陋的网站，这个不断改bug和不断的进行搜索学习的学习过程让我受益匪浅，让我真正的知道，原来编程开发是这样的东西。当然，我的系统还有一些漏洞和不足，我还需要进一步的进行修改和改进，对我的第一个网站进行更多的完善，因为我从中真的找到了快乐和满足。

另外
我的github地址为：https://github.com/FarmerLiuAng/QiangxieSystem-leo
我的网站地址为：
http://119.29.65.190/index.php/admin/login/index.html
进入前端购买界面的账号为：yonghu1 密码为：123
管理员1登陆账号为：liu  密码为：123
管理员2登陆账号为：zhangsan  密码为：123

